<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Video Performances</title>
</head>
<body>
    <video id="video" muted autoplay controls>
        <source src="Big_Buck_Bunny_360_10s_10MB.mp4">
    </video>
    <canvas id="chart" width="640" height="360"></canvas>

    <script>
        const vid = document.getElementById("video");
        const ctx = document.getElementById('chart');
        vid.onloadstart = () => {
            performance.mark('Video load start')
        };
        vid.onloadedmetadata = () => {
            performance.mark('Medtadata load start')
        };
        vid.onloadeddata = () => {
            performance.mark('Metadata loaded')
        };
        vid.oncanplay = () => {
            performance.mark('Video can play');
        };

        vid.onplay = () => {
            performance.mark('Video play requested')
        };
        vid.onplaying = () => {
            performance.mark('Video is playing');
            draw();
        };

        function draw(){
            const allEntries = performance.getEntriesByType("mark");
            const totalDuration = allEntries[allEntries.length-1].startTime;
            const data = [];

            allEntries.forEach((mark, index) => {
                data.push({
                    eventName: mark.name,
                    time: allEntries[index].startTime - allEntries[0].startTime,
                    duration: index > 0 ? allEntries[index].startTime - allEntries[index-1].startTime : allEntries[index].startTime,
                    percent: index > 0 ? (allEntries[index].startTime - allEntries[index-1].startTime) / totalDuration * 100 : allEntries[index].startTime / totalDuration * 100
                });
            });
            console.log(data);
            // draw chart here
        }

    </script>
</body>
</html>